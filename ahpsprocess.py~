def precipprocess(newdate, olddate, picname, year, outzoom, inzoom, district):    
    from osgeo import ogr, gdal
    import os

    xmin=-110.761518
    xmax=-110.4760646
    ymin=32.1035758
    ymax=32.2712308
    
    mypath = os.path.join(os.getcwd(),'static')
    pypath="/usr/bin/python"
    mainpath = "/usr/bin/"
    for item in os.listdir(os.path.join(mypath,'precipdata')):
        if item[-3:]=='bil':
            #oldtif='{0}histunzipped/{1}'.format(mypath,item)
            #oldtifname=item
            bilfile="static/prism/{}".format(item)
            print("bilfile here",bilfile)
    bilvrt = "{}/bilvrt.vrt".format(mypath)
    bilvrtclipped = "{}/bilvrtclipped.vrt".format(mypath)
    colorbil = "{}/colorbil.vrt".format(mypath)
    projfirstnew = "{}/histprojfirstnew.vrt".format(mypath)
    projfirstold = "{}/histprojfirstold.vrt".format(mypath)
    projclippednew="{}/histprojclippednew.vrt".format(mypath)
    projclippedold="{}/histprojclippedold.vrt".format(mypath)
    colorvrt="{}/colorvrt.vrt".format(mypath)
    rgbvrt="{}/rgbvrt.vrt".format(mypath)
    colorpng="{}/buffelapp/public/colorpng.png".format(mypath)
   
    ndvitif="{0}/buffelapp/public/downloads/ndvi{1}.tif".format(mypath,picname)
    qualtif="{0}/buffelapp/public/downloads/qual{1}.tif".format(mypath,picname)    
    #NDVI
    tilefolder=os.path.join(os.getcwd(),'buffelapp','public','tiles')
 
    bilfolder=os.path.join(tilefolder,'bil')
    if not os.path.isdir(bilfolder):
        os.system("mkdir {}".format(bilfolder))
                           
    #Make bil vrt
    os.system("{2}gdalwarp -s_srs EPSG:4269 -t_srs EPSG:4326 -of VRT -overwrite {0} {1} ".format(bilfile, bilvrt,mainpath))
    #os.system("{2}gdalwarp -of VRT -overwrite {0} {1} ".format(bilfile, bilvrt,mainpath))


    
    #os.system("{2}gdalwarp -s_srs EPSG:2163 -t_srs EPSG:4326 -of VRT -overwrite {0} {1} ".format(oldtif, projfirstold,mainpath))
    os.system("{6}gdal_translate {0} {1} -of VRT -projwin {2} {3} {4} {5}".format(bilvrt, bilvrtclipped, xmin,ymax, xmax,ymin,mainpath))
    #os.system("{6}gdal_translate {0} {1} -of VRT -projwin {2} {3} {4} {5}".format(projfirstold, projclippedold, xmin,ymax, xmax,ymin,mainpath))
    #calc = "A-B"

        #New minus old, high values have greened up
    #os.system("{5} {4}gdal_calc.py -A {0} -B {1} --outfile={2} --calc={3} --overwrite".format(projclippednew,projclippedold,projfirstcalc,calc, mainpath,pypath))
    #os.system("{1}gdal_translate -of GTiff {0} {2}".format(projfirstcalc, mainpath, ndvitif))
    
    os.system("{2}gdaldem color-relief -of VRT {0} colorsbil.txt {1}".format(bilvrtclipped,colorbil,mainpath))

    #os.system("{1}gdal_translate {0} {2}".format(colorvrt, mainpath, rgbvrt))
    
    os.system("{0}gdal2tiles.py -z {2}-{3} {1} {4} ".format(mainpath,colorbil, outzoom, inzoom,bilfolder))

    #os.system("{2}gdaldem color-relief -of PNG {0} {3}colorsbil.txt {1}".format(bilvrtclipped,colorpng,mainpath,mypath))
precipprocess(0,1,1,2018,7,13,"rmd")
