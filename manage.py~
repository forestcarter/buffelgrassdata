import download
import process
import dlprecip
import datetime
zoomout=10
zoomin=15
dlcurrent=False
dlhist=False
today=str(datetime.datetime.now())
print (today)
s="{0}{1}{2}".format(today[8:10], today[5:7],today[:4])
n= datetime.date.toordinal(datetime.date(int(s[4:8]), int(s[2:4]), int(s[0:2])))-125
julday=n%365+1
olddate=str(julday-8)
newdate=str(julday-1)
landingvar="landing"
downloadvar="download"

pages=[1,2,3,4]
histpages=[5,6,7,8]
newdate = [julday-1,julday-8, julday-15, julday-22]
olddate = [julday-8,julday-15, julday-22, julday-29]
julday2=224
histnewdate = [julday2-1,julday2-8, julday2-15, julday2-22]
histolddate = [julday2-8,julday2-15, julday2-22, julday2-29]


#Historical
if dlhist==True:
    for num in xrange(len(histpages)):
        try:
            if download.histdownload(histnewdate[num], histolddate[num], histpages[num],"2017"):
                print ("dlworked")
                download.changedates(histnewdate[num], histolddate[num], histpages[num],"2017",julday,landingvar)
                download.changedates(histnewdate[num], histolddate[num], histpages[num],"2017",julday,downloadvar)
                process.process(histnewdate[num], histolddate[num], histpages[num],"2017",zoomout,zoomin,"rmd")
                process.process(histnewdate[num], histolddate[num], histpages[num],"2017",zoomout,zoomin,"tmd")
                print ("Completed request {} ".format(num))
        except Exception as e:
            print(" failed {0} {1} {2} {3}".format(histnewdate[num], histolddate[num], histpages[num],"2017"))
            print (e)
if dlcurrent==True:
    for num in xrange(len(pages)):  
        try:
            if download.histdownload(newdate[num], olddate[num], pages[num],today[:4]):
                print ("dlworked")
                download.changedates(newdate[num], olddate[num], pages[num],today[:4],julday,"landing")
                download.changedates(newdate[num], olddate[num], pages[num],today[:4],julday,"download")
                process.process(newdate[num], olddate[num], pages[num],today[:4],zoomout,zoomin,"rmd")
                process.process(newdate[num], olddate[num], pages[num],today[:4],zoomout,zoomin,"tmd")
                print ("Completed request {} ".format(num))
        except Exception as e2:
            print(" failed {0} {1} {2} {3}".format(newdate[num], olddate[num], pages[num],today[:4]))
            print(e2)

dlprecipitation=True
precipdays=24
if dlprecipitation==True:
    dlprecip.histdownload(precipdays)
